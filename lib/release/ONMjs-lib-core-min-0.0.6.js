(function(){(function(){var e=this;var t;if(typeof require=="function"){try{var n=require("crypto").randomBytes;t=n&&function(){return n(16)}}catch(i){}}if(!t&&e.crypto&&crypto.getRandomValues){var s=new Uint8Array(16);t=function E(){crypto.getRandomValues(s);return s}}if(!t){var r=new Array(16);t=function(){for(var e=0,t;e<16;e++){if((e&3)===0)t=Math.random()*4294967296;r[e]=t>>>((e&3)<<3)&255}return r}}var o=typeof Buffer=="function"?Buffer:Array;var a=[];var c={};for(var l=0;l<256;l++){a[l]=(l+256).toString(16).substr(1);c[a[l]]=l}function d(e,t,n){var i=t&&n||0,s=0;t=t||[];e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){if(s<16){t[i+s++]=c[e]}});while(s<16){t[i+s++]=0}return t}function p(e,t){var n=t||0,i=a;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}var u=t();var h=[u[0]|1,u[1],u[2],u[3],u[4],u[5]];var m=(u[6]<<8|u[7])&16383;var f=0,b=0;function g(e,t,n){var i=t&&n||0;var s=t||[];e=e||{};var r=e.clockseq!=null?e.clockseq:m;var o=e.msecs!=null?e.msecs:(new Date).getTime();var a=e.nsecs!=null?e.nsecs:b+1;var c=o-f+(a-b)/1e4;if(c<0&&e.clockseq==null){r=r+1&16383}if((c<0||o>f)&&e.nsecs==null){a=0}if(a>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}f=o;b=a;m=r;o+=122192928e5;var l=((o&268435455)*1e4+a)%4294967296;s[i++]=l>>>24&255;s[i++]=l>>>16&255;s[i++]=l>>>8&255;s[i++]=l&255;var d=o/4294967296*1e4&268435455;s[i++]=d>>>8&255;s[i++]=d&255;s[i++]=d>>>24&15|16;s[i++]=d>>>16&255;s[i++]=r>>>8|128;s[i++]=r&255;var u=e.node||h;for(var g=0;g<6;g++){s[i+g]=u[g]}return t?t:p(s)}function v(e,n,i){var s=n&&i||0;if(typeof e=="string"){n=e=="binary"?new o(16):null;e=null}e=e||{};var r=e.random||(e.rng||t)();r[6]=r[6]&15|64;r[8]=r[8]&63|128;if(n){for(var a=0;a<16;a++){n[s+a]=r[a]}}return n||p(r)}var y=v;y.v1=g;y.v4=v;y.parse=d;y.unparse=p;y.BufferClass=o;if(e.define&&define.amd){define(function(){return y})}else if(typeof module!="undefined"&&module.exports){module.exports=y}else{var w=e.uuid;y.noConflict=function(){e.uuid=w;return y};e.uuid=y}}).call(this);(function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,s=function(e,t){for(var n in t){if(i.call(t,n))e[n]=t[n]}function s(){this.constructor=e}s.prototype=t.prototype;e.prototype=new s;e.__super__=t.prototype;return e};t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.js=Encapsule.code.lib.js!=null&&Encapsule.code.lib.js||(this.Encapsule.code.lib.js={});Encapsule.code.lib.js.clone=function(e){var t,n,i;try{if(!(e!=null)||typeof e!=="object"){return e}if(e instanceof Date){return new Date(e.getTime())}if(e instanceof RegExp){t="";if(e.global!=null){t+="g"}if(e.ignoreCase!=null){t+="i"}if(e.multiline!=null){t+="m"}if(e.sticky!=null){t+="y"}return new RegExp(e.source,t)}i=new e.constructor;for(n in e){i[n]=Encapsule.code.lib.js.clone(e[n])}return i}catch(s){return Console.message("Encapsule.code.lib.js.clone: "+s)}};Encapsule.code.lib.js.dictionaryLength=function(e){return Object.keys(e).length};t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});e=Encapsule.code.lib.onm;e.implementation=e.implementation!=null&&e.implementation||(e.implementation={});e.implementation.ModelDetails=function(){function t(t,n){var i,s=this;try{this.model=t!=null&&t||function(){throw"Internal error missing model input parameter."}();i=function(e,t,n,r,o,a){var c,l,d,p,u,h,m,f,b,g,v,y,w,E,A,M,k,j,N;try{if(!(e!=null&&e)){throw"Missing object model layout object input parameter! If you specified the namespace declaration via object reference, check the validity of the reference."}if(!(e.jsonTag!=null&&e.jsonTag)){throw"Missing required namespace declaration property 'jsonTag'."}E=e.jsonTag!=null&&e.jsonTag||function(){throw"Namespace declaration missing required `jsonTag` property."}();g=t!=null&&t&&""+t+"."+E||E;u=e.____label!=null&&e.____label||"<no label provided>";d=e.____description!=null&&e.____description||"<no description provided>";p=s.countDescriptors++;m=e.namespaceType!=null&&e.namespaceType||!p&&(e.namespaceType="root")||function(){throw"Internal error unable to determine namespace type."}();b=void 0;if(a!=null&&a){b=Encapsule.code.lib.js.clone(a)}else{b=[]}h=e.namespaceProperties!=null&&e.namespaceProperties||{};A=s.objectModelDescriptorById[p]={archetypePathId:-1,children:[],componentNamespaceIds:[],description:d,extensionPointReferenceIds:[],id:p,idComponent:p,isComponent:false,jsonTag:E,label:u,namespaceType:m,namespaceModelDeclaration:e,namespaceModelPropertiesDeclaration:h,parent:n,parentPathExtensionPoints:b,parentPathIdVector:[],path:g};s.objectModelPathMap[g]=A;if(n!=null&&n){n.children.push(A);A.parentPathIdVector=Encapsule.code.lib.js.clone(n.parentPathIdVector);A.parentPathIdVector.push(n.id)}if(s.rankMax<A.parentPathIdVector.length){s.rankMax=A.parentPathIdVector.length}l=void 0;switch(m){case"extensionPoint":if(!(r!=null&&r)){throw"Internal error: componentDescriptor_ should be defined."}A.idComponent=r.id;l=r;l.extensionPoints[g]=A;y=void 0;c=void 0;if(e.componentArchetype!=null&&e.componentArchetype){y=true;c=e.componentArchetype}else if(e.componentArchetypePath!=null&&e.componentArchetypePath){y=false;v=e.componentArchetypePath;f=s.objectModelPathMap[v];if(!(f!=null&&f)){throw"Extension point namespace '"+g+"' component archetype '"+v+"' was not found and is invalid."}if(f.namespaceType!=="component"){throw"Extension point namespace '"+g+"' declares component archetype '"+v+"' which is not a 'component' namespace type."}f.extensionPointReferenceIds.push(A.id);A.archetypePathId=f.id;s.countExtensionReferences++}else{throw"Cannot process extension point declaration because its corresponding extension archetype is missing from the object model declaration."}M=Encapsule.code.lib.js.clone(b);M.push(p);s.countExtensionPoints++;if(y){i(c,g,A,l,A.parentPathIdVector,M)}break;case"component":A.isComponent=true;A.extensionPoints={};n.archetypePathId=p;l=A;s.countExtensions++;s.countComponents++;break;case"root":if(r!=null||l){throw"Internal error: componentDescriptor_ should be undefined."}A.isComponent=true;A.extensionPoints={};l=A;s.countComponents++;break;case"child":if(!(r!=null&&r)){throw"Internal error: componentDescriptor_ should be defined."}A.idComponent=r.id;l=r;s.countChildren++;break;default:throw"Unrecognized namespace type '"+m+"' in object model namespace declaration."}s.objectModelDescriptorById[A.idComponent].componentNamespaceIds.push(A.id);if(!(e.subNamespaces!=null&&e.subNamespaces)){return true}N=e.subNamespaces;for(k=0,j=N.length;k<j;k++){w=N[k];i(w,g,A,l,A.parentPathIdVector,b)}return true}catch(D){throw"ONMjs.implementation.ModelDetails.buildOMDescriptorFromLayout fail: "+D}};this.getNamespaceDescriptorFromPathId=function(e){var t;try{if(!(e!=null)){throw"Missing path ID parameter!"}if(e<0||e>=s.objectModelDescriptorById.length){throw"Out of range path ID '"+e+" cannot be resolved."}t=s.objectModelDescriptorById[e];if(!(t!=null&&t)){throw"Internal error getting namespace descriptor for path ID="+e+"!"}return t}catch(n){throw"ONMjs.implementation.ModelDetails.getNamespaceDescriptorFromPathId failure: "+n}};this.getNamespaceDescriptorFromPath=function(e){try{return s.getNamespaceDescriptorFromPathId(s.getPathIdFromPath(e))}catch(t){throw"ONMjs.implementation.ModelDetails.getNamespaceDescriptorFromPath failure: "+t}};this.getPathIdFromPath=function(e){var t,n;try{if(!(e!=null&&e)){throw"Missing object model path parameter!"}t=s.objectModelPathMap[e];if(!(t!=null&&t)){throw"Invalid object model path '"+objectModelPath_+"' cannot be resolved."}n=t.id;if(!(n!=null)){throw"Internal error: Invalid object model descriptor doesn't support id property for path '"+objectModelPath_+"."}return n}catch(i){throw"ONMjs.implementation.ModelDetails.getPathIdFromPath fail: "+i}};this.getPathFromPathId=function(e){var t,n;try{t=s.getNamespaceDescriptorFromPathId(e);if(!(t!=null&&t)){throw"Internal error: Can't find object descriptor for valid path ID '"+e+"."}n=t.path;if(!(n!=null&&n)){throw"Internal error: Invalid object model descriptor doesn't support path property for path '"+objectModelPath_+"."}return n}catch(i){throw"ONMjs.implementation.ModelDetails.getPathFromPathId fail: "+i}};this.createAddressFromPathId=function(t){var n,i,s,r,o,a,c,l;try{if(!(t!=null)){throw"Missing path input parameter."}o=this.getNamespaceDescriptorFromPathId(t);i=new e.Address(this.model);a=void 0;r=Encapsule.code.lib.js.clone(o.parentPathIdVector);r.push(o.id);for(c=0,l=r.length;c<l;c++){s=r[c];n=this.getNamespaceDescriptorFromPathId(s);if(n.namespaceType==="component"){i.implementation.pushToken(a)}a=new e.AddressToken(this.model,n.idExtensionPoint,void 0,n.id)}i.implementation.pushToken(a);return i}catch(d){throw"ONMjs.implementation.ModelDetails.getAddressFromPathId failure: "+d}};if(!(n!=null&&n)){throw"Missing object model delcaration input parameter!"}if(!(n.jsonTag!=null&&n.jsonTag)){throw"Missing required root namespace property 'jsonTag'."}this.model.jsonTag=n.jsonTag;this.model.label=n.____label!=null&&n.____label||"<no label provided>";this.model.description=n.____description!=null&&n.____description||"<no description provided>";this.objectModelDeclaration=Encapsule.code.lib.js.clone(n);Object.freeze(this.objectModelDeclaration);if(!(this.objectModelDeclaration!=null&&this.objectModelDeclaration)){throw"Failed to deep copy (clone) source object model declaration."}this.objectModelPathMap={};this.objectModelDescriptorById=[];this.countDescriptors=0;this.countComponents=0;this.countExtensionPoints=0;this.countExtensions=0;this.countExtensionReferences=0;this.countChildren=0;this.rankMax=0;i(n);if(this.countExtensionPoints!==this.countExtensions+this.countExtensionReferences){throw"Layout declaration error: extension point and extension descriptor counts do not match. countExtensionPoints="+this.countExtensionPoints+" countExtensions="+this.countExtensions}if(this.countComponents!==this.countExtensionPoints+1-this.countExtensionReferences){throw"Layout declaration error: component count should be "+("extension count + 1 - extension references. componentCount="+this.countComponents+" ")+(" countExtensions="+this.countExtensions+" extensionReferences="+this.countExtensionReferences)}Object.freeze(this.objectModelPathMap);Object.freeze(this.objectModelDescriptorById)}catch(r){throw"ONMjs.implementation.ModelDetails failure: "+r}}return t}();e.Model=function(){function t(t){var n=this;try{this.implementation=new e.implementation.ModelDetails(this,t);this.createRootAddress=function(){try{return new e.Address(n,[new e.AddressToken(n,void 0,void 0,0)])}catch(t){throw"ONMjs.Model.getRootAddress failure: "+t}};this.createPathAddress=function(e){var t,i;try{i=n.implementation.getPathIdFromPath(e);t=n.implementation.createAddressFromPathId(i);return t}catch(s){throw"ONMjs.Model.getAddressFromPath failure: "+s}};this.getSemanticBindings=function(){try{return n.implementation.objectModelDeclaration.semanticBindings}catch(e){throw"ONMjs.Model.getSemanticBindings failure: "+e}};this.isEqual=function(e){try{return n.jsonTag===e.jsonTag}catch(t){throw"ONMjs.Model.isEqual failure: "+t}}}catch(i){throw"ONMjs.Model construction fail: "+i}}return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});e=Encapsule.code.lib.onm;e.implementation=e.implementation!=null&&e.implementation||(e.implementation={});e.implementation.AddressDetails=function(){function t(t,n,i){var s,r,o,a,c=this;try{this.address=t!=null&&t||function(){throw"Internal error missing address input parameter."}();this.model=n!=null&&n||function(){throw"Internal error missing model input paramter."}();this.getModelPath=function(){var e;try{if(!c.tokenVector.length){throw"Invalid address contains no address tokens."}e=c.getLastToken();return e.namespaceDescriptor.path}catch(t){throw"ONMjs.implementation.AddressDetails.getModelPathFromAddress failure: "+t}};this.getModelDescriptorFromSubpath=function(e){var t;try{t=""+c.getModelPath()+"."+e;return c.model.implementation.getNamespaceDescriptorFromPath(t)}catch(n){throw"ONMjs.implementation.AddressDetails.getModelDescriptorFromSubpath failure: "+n}};this.createSubpathIdAddress=function(t){var n,i,s,r,o,a;try{if(!(t!=null&&t>-1)){throw"Missing namespace path ID input parameter."}i=c.getLastToken();n=i.componentDescriptor;a=c.model.implementation.getNamespaceDescriptorFromPathId(t);if(a.idComponent!==n.id){throw"Invalid path ID specified does not resolve to a namespace in the same component as the source address."}r=new e.AddressToken(c.model,i.idExtensionPoint,i.key,t);o=c.tokenVector.length>0&&c.tokenVector.slice(0,c.tokenVector.length-1)||[];o.push(r);s=new e.Address(c.model,o);return s}catch(l){throw"ONMjs.implementation.AddressDetails.createSubpathIdAddress failure: "+l}};this.pushToken=function(e){var t;try{if(c.tokenVector.length){t=c.tokenVector[c.tokenVector.length-1];c.validateTokenPair(t,e)}c.tokenVector.push(e.clone());if(e.componentDescriptor.id===0){c.complete=true}if(e.keyRequired){c.keysRequired=true}if(!e.isQualified()){c.keysSpecified=false}c.humanReadableString=void 0;c.hashString=void 0;return c.address}catch(n){throw"ONMjs.implementation.AddressDetails.pushToken failure: "+n}};this.validateTokenPair=function(e,t){try{if(!(e!=null&&e&&t!=null&&t)){throw"Internal error: input parameters are not correct."}if(!t.keyRequired){throw"Child token is invalid because it specifies a namespace in the root component."}if(e.namespaceDescriptor.id!==t.extensionPointDescriptor.id){throw"Child token is invalid because the parent token does not select the required extension point namespace."}if(!e.isQualified()&&t.isQualified()){throw"Child token is invalid because the parent token is unqualified and the child is qualified."}return true}catch(n){throw"ONMjs.implementation.AddressDetails.validateTokenPair the specified parent and child tokens are incompatible and cannot be used to form an address: "+n}};this.getLastToken=function(){try{if(!c.tokenVector.length){throw"Illegal call to getLastToken on uninitialized address class instance."}return c.tokenVector[c.tokenVector.length-1]}catch(e){throw"ONMjs.implementation.AddressDetails.getLastToken failure: "+e}};this.getDescriptor=function(){try{return c.getLastToken().namespaceDescriptor}catch(e){throw"ONMjs.implementation.AddressDetails.getDescriptor failure: "+e}};this.tokenVector=[];this.parentExtensionPointId=-1;this.complete=false;this.keysRequired=false;this.keysSpecified=true;a=i!=null&&i||[];for(r=0,o=a.length;r<o;r++){s=a[r];this.pushToken(s)}this.parentAddressesAscending=void 0;this.parentAddressesDescending=void 0;this.subnamespaceAddressesAscending=void 0;this.subnamespaceAddressesDescending=void 0;this.subcomponentAddressesAscending=void 0;this.subcomponentsAddressesDescending=void 0;this.humanReadableString=void 0;this.hashString=void 0}catch(l){throw"ONMjs.implementation.AddressDetails failure: "+l}}return t}();e.Address=function(){function t(t,i){this.visitExtensionPointAddresses=n(this.visitExtensionPointAddresses,this);this.visitChildAddresses=n(this.visitChildAddresses,this);this.visitSubaddressesDescending=n(this.visitSubaddressesDescending,this);this.visitSubaddressesAscending=n(this.visitSubaddressesAscending,this);this.visitParentAddressesDescending=n(this.visitParentAddressesDescending,this);this.visitParentAddressesAscending=n(this.visitParentAddressesAscending,this);this.getPropertiesModel=n(this.getPropertiesModel,this);this.getModel=n(this.getModel,this);this.createSubcomponentAddress=n(this.createSubcomponentAddress,this);this.createComponentAddress=n(this.createComponentAddress,this);this.createSubpathAddress=n(this.createSubpathAddress,this);this.createParentAddress=n(this.createParentAddress,this);this.clone=n(this.clone,this);this.isEqual=n(this.isEqual,this);this.isRoot=n(this.isRoot,this);this.getHashString=n(this.getHashString,this);this.getHumanReadableString=n(this.getHumanReadableString,this);var s=this;try{this.model=t!=null&&t||function(){throw"Missing required object model input parameter."}();this.implementation=new e.implementation.AddressDetails(this,t,i);this.isComplete=function(){return s.implementation.complete};this.isQualified=function(){return!s.implementation.keysRequired||s.implementation.keysSpecified};this.isResolvable=function(){return s.isComplete()&&s.isQualified()};this.isCreatable=function(){return s.isComplete()&&s.implementation.keysRequired&&!s.implementation.keysSpecified}}catch(r){throw"ONMjs.Address error: "+r}}t.prototype.getHumanReadableString=function(){var e,t,n,i,s,r;try{if(this.implementation.humanReadableString!=null&&this.implementation.humanReadableString){return this.implementation.humanReadableString}t=0;e="";r=this.implementation.tokenVector;for(i=0,s=r.length;i<s;i++){n=r[i];if(!t){e+=""+n.model.jsonTag+"."}if(n.key!=null&&n.key){e+="."+n.key+"."}else{if(n.idExtensionPoint>0){e+="."}}e+=""+n.idNamespace;t++}this.implementation.humanReadableString=e;return e}catch(o){throw"ONMjs.Address.getHumanReadableString failure: "+o}};t.prototype.getHashString=function(){var e;try{if(this.implementation.hashString!=null&&this.implementation.hashString){return this.implementation.hashString}e=this.getHumanReadableString();this.implementation.hashString=encodeURIComponent(e).replace(/[!'()]/g,escape).replace(/\*/g,"%2A");return this.implementation.hashString}catch(t){throw"ONMjs.Address.getHashString failure: "+t}};t.prototype.isRoot=function(){try{return this.implementation.getLastToken().idNamespace===0}catch(e){throw"CNMjs.Address.isRoot failure: "+e}};t.prototype.isEqual=function(e){var t,n,i,s;try{if(!(e!=null&&e)){throw"Missing address input parameter."}if(this.implementation.tokenVector.length!==e.implementation.tokenVector.length){return false}n=true;t=0;while(t<this.implementation.tokenVector.length){i=this.implementation.tokenVector[t];s=e.implementation.tokenVector[t];if(!i.isEqual(s)){n=false;break}t++}return n}catch(r){throw"ONMjs.Address.isEqual failure: "+r}};t.prototype.clone=function(){try{return new e.Address(this.model,this.implementation.tokenVector)}catch(t){throw"ONMjs.Address.clone failure: "+t}};t.prototype.createParentAddress=function(t){var n,i,s,r,o,a;try{if(!this.implementation.tokenVector.length){throw"Invalid address contains no address tokens."}i=t!=null&&t||1;a=this.implementation.tokenVector.length-1;o=this.implementation.tokenVector[a--];if(o.namespaceDescriptor.id===0){return void 0}while(i){n=o.namespaceDescriptor;if(n.id===0){break}if(n.namespaceType!=="component"){o=new e.AddressToken(o.model,o.idExtensionPoint,o.key,n.parent.id)}else{o=a!==-1&&this.implementation.tokenVector[a--]||function(){throw"Internal error: exhausted token stack."}()}i--}r=a<0&&[]||this.implementation.tokenVector.slice(0,a+1);s=new e.Address(o.model,r);s.implementation.pushToken(o);return s}catch(c){throw"ONMjs.Address.createParentAddress failure: "+c}};t.prototype.createSubpathAddress=function(t){var n,i,s,r,o,a,c,l,d,p,u,h;try{if(!(t!=null&&t)){throw"Missing subpath input parameter."}c=this.implementation.getModelDescriptorFromSubpath(t);n=this.implementation.getDescriptor();if(n.namespaceType==="extensionPoint"&&c.namespaceType!=="component"){throw"Invalid subpath string must begin with the name of the component contained by the base address' extension point."}i=n.parentPathIdVector.length;l=c.parentPathIdVector.length;if(l-i<1){throw"Internal error due to failed consistency check."}d=c.parentPathIdVector.slice(i+1,l);d.push(c.id);s=this.implementation.tokenVector.slice(0,this.implementation.tokenVector.length-1)||[];o=new e.Address(this.model,s);p=this.implementation.getLastToken().clone();for(u=0,h=d.length;u<h;u++){a=d[u];r=this.model.implementation.getNamespaceDescriptorFromPathId(a);switch(r.namespaceType){case"component":o.implementation.pushToken(p);p=new e.AddressToken(p.model,p.namespaceDescriptor.id,void 0,a);break;default:p=new e.AddressToken(p.model,p.idExtensionPoint,p.key,a)}}o.implementation.pushToken(p);return o}catch(m){throw"ONMjs.Address.createSubpathAddress failure: "+m}};t.prototype.createComponentAddress=function(){var e,t;try{e=this.implementation.getDescriptor();if(e.isComponent){return this.clone()}t=this.implementation.createSubpathIdAddress(e.idComponent);return t}catch(n){throw"ONMjs.Address.createComponentAddress failure: "+n}};t.prototype.createSubcomponentAddress=function(){var t,n;try{t=this.implementation.getDescriptor();if(t.namespaceType!=="extensionPoint"){throw"Unable to determine subcomponent to create because this address does not specifiy an extension point namespace."}n=new e.AddressToken(this.model,t.id,void 0,t.archetypePathId);return this.clone().implementation.pushToken(n)}catch(i){throw"ONMjs.Address.createSubcomponentAddress failure: "+i}};t.prototype.getModel=function(){try{return this.implementation.getDescriptor().namespaceModelDeclaration}catch(e){throw"ONMjs.Address.getModel failure: "+e}};t.prototype.getPropertiesModel=function(){try{return this.implementation.getDescriptor().namespaceModelPropertiesDeclaration}catch(e){throw"ONMjs.Address.getPropertiesModel failure: "+e}};t.prototype.visitParentAddressesAscending=function(e){var t,n,i,s,r=this;try{if(!(e!=null&&e)){return false}if(!(this.parentAddressesAscending!=null&&this.parentAddressesAscending)){this.parentAddressesAscending=[];this.visitParentAddressesDescending(function(e){r.parentAddressesAscending.push(e);return true});this.parentAddressesAscending.reverse()}if(!this.parentAddressesAscending.length){return false}s=this.parentAddressesAscending;for(n=0,i=s.length;n<i;n++){t=s[n];try{e(t)}catch(o){throw"Failure occurred inside your registered callback function implementation: "+o}}return true}catch(o){throw"ONMjs.Address.visitParentAddressesAscending failure: "+o}};t.prototype.visitParentAddressesDescending=function(e){var t,n,i,s,r;try{if(!(e!=null&&e)){return false}if(!(this.parentAddressesDesending!=null&&this.parentAddressesDesceding)){this.parentAddressesDescending=[];n=this.createParentAddress();while(n){this.parentAddressesDescending.push(n);n=n.createParentAddress()}}if(!this.parentAddressesDescending.length){return false}r=this.parentAddressesDescending;for(i=0,s=r.length;i<s;i++){t=r[i];try{e(t)}catch(o){throw"Failure occurred inside your registered callback function implementation: "+o}}return true}catch(o){throw"ONMjs.Address.visitParentAddressesDescending failure: "+o}};t.prototype.visitSubaddressesAscending=function(e){var t,n,i,s,r,o,a,c,l,d;try{if(!(e!=null&&e)){return false}if(!(this.subnamespaceAddressesAscending!=null&&this.subnamespaceAddressesAscending)){this.subnamespaceAddressesAscending=[];n=this.implementation.getDescriptor();l=n.componentNamespaceIds;for(r=0,a=l.length;r<a;r++){s=l[r];i=this.implementation.createSubpathIdAddress(s);this.subnamespaceAddressesAscending.push(i)}}d=this.subnamespaceAddressesAscending;for(o=0,c=d.length;o<c;o++){t=d[o];try{e(t)}catch(p){throw"Failure occurred inside your registered callback function implementation: "+p}}return true}catch(p){throw"ONMjs.Address.visitSubaddressesAscending failure: "+p}};t.prototype.visitSubaddressesDescending=function(e){var t,n,i,s,r=this;try{if(!(e&&e)){return false}if(!(this.subnamespaceAddressesDescending!=null&&this.subnamespaceAddressesDescending)){this.subnamespaceAddressesDescending=[];this.visitSubaddressesAscending(function(e){return r.subnamespaceAddressesDescending.push(e)});this.subnamespaceAddressesDescending.reverse()}s=this.subnamespaceAddressesDescending;for(n=0,i=s.length;n<i;n++){t=s[n];try{e(t)}catch(o){throw"Failure occurred inside your registered callback function implementation: "+o}}return true}catch(o){throw"ONMjs.Address.visitSubaddressesAscending failure: "+o}};t.prototype.visitChildAddresses=function(e){var t,n,i,s,r,o;try{if(!(e!=null&&e)){return false}i=this.implementation.getDescriptor();o=i.children;for(s=0,r=o.length;s<r;s++){n=o[s];t=this.implementation.createSubpathIdAddress(n.id);try{e(t)}catch(a){throw"Failure occurred inside your registered callback function implementation: "+a}}return true}catch(a){throw"ONMjs.Address.visitChildAddresses failure: "+a}};t.prototype.visitExtensionPointAddresses=function(e){var t,n,i,s,r,o,a,c,l;try{if(!(e!=null&&e)){return false}if(!(this.extensionPointAddresses!=null&&this.extensionPointAddresses)){this.extensionPointAddresses=[];s=this.implementation.getDescriptor();c=s.extensionPoints;for(r in c){i=c[r];n=this.implementation.createSubpathIdAddress(i.id);this.extensionPointAddresses.push(n)}}l=this.extensionPointAddresses;for(o=0,a=l.length;o<a;o++){t=l[o];e(t)}return true}catch(d){throw"ONMjs.Address.visitExtensionPointAddresses failure: "+d}};return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});e=Encapsule.code.lib.onm;e.implementation=e.implementation!=null&&e.implementation||(e.implementation={});e.implementation.binding=e.implementation.binding!=null&&e.implementation.binding||(e.implementation.binding={});e.implementation.binding.InitializeNamespaceProperties=function(e,t){var n,i,s,r;try{if(!(e!=null&&e)){throw"Missing data reference input parameter."}if(!(t!=null&&t)){throw"Missing descriptor input parameter."}if(t.userImmutable!=null&&t.userImmutable){s=t.userImmutable;for(i in s){n=s[i];if(n.fnCreate!=null&&n.fnCreate){e[i]=n.fnCreate()}}}if(t.userMutable!=null&&t.userMutable){r=t.userMutable;for(i in r){n=r[i];if(n.fnCreate!=null&&n.fnCreate){e[i]=n.fnCreate()}}}return true}catch(o){throw"ONMjs.implementation.binding.InitializeNamespaceProperties failure "+o+"."}};e.implementation.binding.VerifyNamespaceProperties=function(e,t){var n,i,s,r,o;try{if(!(e!=null&&e)){throw"Missing data reference input parameter."}if(!(t!=null&&t)){throw"Missing descriptor input parameter."}if(t.userImmutable!=null&&t.userImmutable){r=t.userImmutable;for(i in r){n=r[i];s=e[i];if(!(s!=null)){throw"Expected immutable member '"+i+"' not found."}}}if(t.userMutable!=null&&t.userMutable){o=t.userMutable;for(i in o){n=o[i];s=e[i];if(!(s!=null)){throw"Expected mutable member '"+i+"' not found."}}}return true}catch(a){throw"ONMjs.implementation.binding.VerifyNamespaceMembers failure "+a+"."}};e.implementation.binding.InitializeComponentNamespaces=function(t,n,i,s,r){var o,a,c,l,d;try{if(!(n!=null&&n)){throw"Missing data reference input parameter."}if(!(i!=null&&i)){throw"Missing descriptor input parameter."}if(!(s!=null&&s)){throw"Missing extension point ID input parameter."}d=i.children;for(c=0,l=d.length;c<l;c++){o=d[c];if(o.namespaceType!=="component"){a=e.implementation.binding.ResolveNamespaceDescriptor({},t,n,o,r,"new");e.implementation.binding.InitializeComponentNamespaces(t,a.dataReference,o,s,r)}}return true}catch(p){throw"ONMjs.implementation.binding.InitializeComponentNamespaces failure: "+p+"."}};e.implementation.binding.VerifyComponentNamespaces=function(e,t,n,i){try{if(!(t!=null&&t)){throw"Missing data reference input parameter."}if(!(n!=null&&n)){throw"Missing descriptor input parameter."}return true}catch(s){throw"ONMjs.implementation.binding.VerifyComponentNamespaces failure: "+s+"."}};e.implementation.binding.ResolveNamespaceDescriptor=function(t,n,i,s,r,o){var a,c,l;try{if(!(t!=null&&t)){throw"Internal error: missing resolve actions structure input parameter."}if(!(i!=null&&i)){throw"Internal error: missing parent data reference input parameter."}if(!(s!=null&&s)){throw"Internal error: missing object model descriptor input parameter."}if(!(o!=null&&o)){throw"Internal error: missing mode input parameter."}a=s.namespaceType!=="component"&&s.jsonTag||r||void 0;l={jsonTag:a,dataReference:a!=null&&a&&i[a]||void 0,dataParentReference:i,key:r,mode:o,descriptor:s,store:n,created:false};switch(o){case"bypass":if(!(l.dataReference!=null&&l.dataReference)){throw"Internal error: Unable to resolve "+s.namespaceType+" namespace descriptor in bypass mode."}break;case"new":if(l.dataReference!=null&&l.dataReference){break}c={};e.implementation.binding.InitializeNamespaceProperties(c,s.namespaceModelPropertiesDeclaration);if(s.namespaceType==="component"){if(!(t.getUniqueKey!=null&&t.getUniqueKey)){throw"In order to create new components at runtime you must define the semanticBindings.getUniqueKey function in your data model declaration object."}l.key=l.jsonTag=t.getUniqueKey(c);if(!(l.key!=null&&l.key)){throw"Unable to obtain key for new data component from function semanticBindings.getUniqueKey."}}l.dataReference=l.dataParentReference[l.jsonTag]=c;l.created=true;break;case"strict":if(!(resolveResult.dataReference!=null&&resolveResult.dataReference)){throw"Internal error: Unable to resolve  "+s.namespaceType+" namespace descriptor in strict mode."}e.implementation.binding.VerifyNamespaceProperties(result.dataReference,s.namespaceModelPropertiesDeclaration);break;default:throw"Unrecognized mode parameter value."}return l}catch(d){throw"ONMjs.implementation.binding.ResolveNamespaceDescriptor failure: "+d}};e.implementation.AddressTokenBinder=function(){function t(t,n,i,s){var r,o,a,c,l,d,p,u,h,m,f,b,g,v;try{this.store=t!=null&&t||function(){throw"Missing object store input parameter."}();l=t.model;this.parentDataReference=n!=null&&n||function(){throw"Missing parent data reference input parameter."}();if(!(i!=null&&i)){throw"Missing object model address token object input parameter."}if(!(s!=null&&s)){throw"Missing mode input parameter."}this.dataReference=void 0;this.resolvedToken=i.clone();b=i.namespaceDescriptor;f=i.componentDescriptor;m=l.getSemanticBindings();c=m!=null&&m&&m.getUniqueKey!=null&&m.getUniqueKey||void 0;u={getUniqueKey:c};h=e.implementation.binding.ResolveNamespaceDescriptor(u,t,this.parentDataReference,i.componentDescriptor,i.key,s);this.dataReference=h.dataReference;if(h.created){this.resolvedToken.key=h.key}o=i.extensionPointDescriptor!=null&&i.extensionPointDescriptor&&i.extensionPointDescriptor.id||-1;if(s==="new"&&h.created){e.implementation.binding.InitializeComponentNamespaces(t,this.dataReference,f,o,this.resolvedToken.key)}if(s==="strict"){e.implementation.binding.VerifyComponentNamespaces(t,resolveResult.dataReference,f,o)}if(b.isComponent){return}a=b.parentPathIdVector.length-f.parentPathIdVector.length-1;d=a&&b.parentPathIdVector.slice(-a)||[];for(g=0,v=d.length;g<v;g++){p=d[g];r=l.implementation.getNamespaceDescriptorFromPathId(p);h=e.implementation.binding.ResolveNamespaceDescriptor(u,t,h.dataReference,r,h.key,s)}h=e.implementation.binding.ResolveNamespaceDescriptor(u,t,h.dataReference,b,h.key,s);this.dataReference=h.dataReference;return}catch(y){throw"ONMjs.implementation.AddressTokenBinder failure: "+y}}return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});
Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});e=Encapsule.code.lib.onm;e.AddressToken=function(){function t(e,t,i,s){this.isRoot=n(this.isRoot,this);this.isQualified=n(this.isQualified,this);this.isEqual=n(this.isEqual,this);this.clone=n(this.clone,this);try{this.model=e!=null&&e||function(){throw"Missing object model input parameter."}();if(!(s!=null)){throw"Missing target namespace ID input parameter."}this.idNamespace=s;this.namespaceDescriptor=e.implementation.getNamespaceDescriptorFromPathId(s);this.idComponent=this.namespaceDescriptor.idComponent;this.componentDescriptor=e.implementation.getNamespaceDescriptorFromPathId(this.idComponent);this.key=this.componentDescriptor.id>0&&i!=null&&i||void 0;this.keyRequired=false;this.idExtensionPoint=t!=null&&t||-1;this.extensionPointDescriptor=void 0;if(this.componentDescriptor.id===0){return}this.keyRequired=true;if(this.idExtensionPoint===-1&&!this.componentDescriptor.extensionPointReferenceIds.length){this.idExtensionPoint=this.componentDescriptor.parent.id}if(!this.idExtensionPoint){throw"You must specify the ID of the parent extension point when creating a token addressing a '"+this.componentDescriptor.path+"' component namespace."}this.extensionPointDescriptor=this.model.implementation.getNamespaceDescriptorFromPathId(this.idExtensionPoint);if(!(this.extensionPointDescriptor!=null&&this.extensionPointDescriptor)){throw"Internal error: unable to resolve extension point object model descriptor in request."}if(this.extensionPointDescriptor.namespaceType!=="extensionPoint"){throw"Invalid selector key object specifies an invalid parent extension point ID. Not an extension point."}if(this.extensionPointDescriptor.archetypePathId!==this.componentDescriptor.id){throw"Invalid selector key object specifies unsupported extension point / component ID pair."}return}catch(r){throw"ONMjs.AddressToken failure: "+r}}t.prototype.clone=function(){return new e.AddressToken(this.model,this.extensionPointDescriptor!=null&&this.extensionPointDescriptor&&this.extensionPointDescriptor.id||-1,this.key,this.namespaceDescriptor.id)};t.prototype.isEqual=function(e){var t;try{if(!(e!=null&&e)){throw"Missing token input parameter."}t=this.idNamespace===e.idNamespace&&this.key===e.key&&this.idExtensionPoint===e.idExtensionPoint;return t}catch(n){throw"ONMjs.AddressToken.isEqual failure: "+n}};t.prototype.isQualified=function(){return!this.keyRequired||this.key!=null&&this.key||false};t.prototype.isRoot=function(){return!this.componentId};return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});e=Encapsule.code.lib.onm;e.Namespace=function(){function t(t,i,s){this.visitExtensionPointSubcomponents=n(this.visitExtensionPointSubcomponents,this);this.update=n(this.update,this);this.toJSON=n(this.toJSON,this);this.data=n(this.data,this);this.getResolvedLabel=n(this.getResolvedLabel,this);this.getResolvedAddress=n(this.getResolvedAddress,this);var r,o,a,c,l,d,p,u,h,m,f,b,g,v,y=this;try{if(!(t!=null&&t)){throw"Missing object store input parameter."}this.store=t;r=void 0;if(!(i!=null&&i&&i.implementation.tokenVector.length)){p=t.model;r=new e.Address(p,[new e.AddressToken(p,void 0,void 0,0)])}else{r=i}h=t.model.jsonTag;u=r.model.jsonTag;if(h!==u){throw"You cannot access a '"+h+"' store namespace with a '"+u+"' object model address!"}if(!r.isComplete()){throw"Specified address is invalid because the first address token does not specify the object store's root component."}d=s!=null&&s||"bypass";if(d!=="new"&&!r.isResolvable()){throw"Specified address is unresolvable in "+d+" mode."}this.dataReference=t.dataReference!=null&&t.dataReference||function(){throw"Cannot resolve object store's root data reference."}();this.resolvedTokenArray=[];this.getResolvedToken=function(){return y.resolvedTokenArray.length&&y.resolvedTokenArray[y.resolvedTokenArray.length-1]||void 0};v=r.implementation.tokenVector;for(b=0,g=v.length;b<g;b++){o=v[b];f=new e.implementation.AddressTokenBinder(t,this.dataReference,o,d);this.resolvedTokenArray.push(f.resolvedToken);this.dataReference=f.dataReference;if(d==="new"){if(o.idComponent){if(!(o.key!=null&&o.key)){m=new e.Address(this.store.model,this.resolvedTokenArray);a=m.createComponentAddress();this.store.reifier.reifyStoreComponent(a);c=a.createParentAddress();l=this.store.openNamespace(c);l.update()}}}true}this.resolvedAddress=void 0}catch(w){throw"ONMjs.Namespace failure: "+w}}t.prototype.getResolvedAddress=function(){try{if(this.resolvedAddress!=null&&this.resolvedAddress){return this.resolvedAddress}this.resolvedAddress=new e.Address(this.store.model,this.resolvedTokenArray);return this.resolvedAddress}catch(t){throw"ONMjs.Namespace.address failure: "+t}};t.prototype.getResolvedLabel=function(){var e,t,n,i;try{t=this.getResolvedToken().namespaceDescriptor;i=this.store.model.getSemanticBindings();e=i!=null&&i&&i.getLabel!=null&&i.getLabel||void 0;n=void 0;if(e!=null&&e){n=e(this.data(),t)}else{n=t.label}return n}catch(s){throw"ONMjs.Namespace.getResolvedLabel failure: "+s}};t.prototype.data=function(){return this.dataReference};t.prototype.toJSON=function(e,t){var n,i,s,r;try{n=this.getResolvedToken().namespaceDescriptor;s={};s[n.jsonTag]=this.data();r=t!=null&&t||0;i=JSON.stringify(s,e,r);if(!(i!=null&&i)){throw"Cannot serialize Javascript object to JSON!"}return i}catch(o){throw"ONMjs.Namespace.toJSON failure: "+o}};t.prototype.update=function(){var e,t,n,i,s,r,o,a=this;try{e=this.getResolvedAddress();s=this.store.model.getSemanticBindings();r=s!=null&&s&&s.update!=null&&s.update||void 0;if(r!=null&&r){r(this.data());e.visitParentAddressesDescending(function(e){var t;t=a.store.openNamespace(e).data();return r(t)})}n=0;t=false;o=[];while(e!=null&&e){i=e.implementation.getDescriptor();if(n===0){this.store.reifier.dispatchCallback(e,"onNamespaceUpdated",void 0)}else{this.store.reifier.dispatchCallback(e,"onSubnamespaceUpdated",void 0)}if(i.namespaceType==="component"||i.namespaceType==="root"){if(!t){this.store.reifier.dispatchCallback(e,"onComponentUpdated",void 0);t=true}else{this.store.reifier.dispatchCallback(e,"onSubcomponentUpdated",void 0)}}e=e.createParentAddress();o.push(n++)}return o}catch(c){throw"ONMjs.Namespace.update failure: "+c}};t.prototype.visitExtensionPointSubcomponents=function(t){var n,i,s,r,o,a;try{r=this.getResolvedToken();if(!(r!=null&&r)){throw"Internal error: unable to resolve token."}if(r.namespaceDescriptor.namespaceType!=="extensionPoint"){throw"You may only visit the subcomponents of an extension point namespace."}a=this.data();for(i in a){s=a[i];n=this.getResolvedAddress().clone();o=new e.AddressToken(this.store.model,r.idNamespace,i,r.namespaceDescriptor.archetypePathId);n.implementation.pushToken(o);try{t(n)}catch(c){throw"Failure occurred inside your callback function implementation: "+c}}return true}catch(c){throw"ONMjs.Namepsace.visitExtensionPointSubcomponents failure: "+c}};return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});Encapsule.code.lib.onm.implementation=Encapsule.code.lib.onm.implementation!=null&&Encapsule.code.lib.onm.implementation||(this.Encapsule.code.lib.onm.implementation={});e=Encapsule.code.lib.onm;e.implementation.StoreReifier=function(){function t(t){var n=this;try{this.store=t;this.dispatchCallback=function(e,t,i){var s,r,o,a,c,l;try{if(i!=null&&i){r=n.store.observers[i];if(!(r!=null&&r)){throw"Internal error: unable to resolve observer ID to obtain callback interface."}s=r[t];if(s!=null&&s){try{return s(n.store,i,e)}catch(d){throw"An error occurred in the '"+t+"' method of your observer interface: "+d}}}else{c=n.store.observers;l=[];for(a in c){r=c[a];s=r[t];if(s!=null&&s){try{l.push(s(n.store,a,e))}catch(d){throw"An error occurred in the '"+t+"' method of your observer interface: "+d}}else{l.push(void 0)}}return l}}catch(d){o="ONMjs.implementation.StoreRefier.dispatchCallback failure while processing "+("address='"+e.getHumanReadableString()+"', callback='"+t+"', observer='"+(i!=null&&i||"[broadcast all]")+"': "+d);throw o}};this.reifyStoreComponent=function(e,t){var i;try{if(!(e!=null&&e)){throw"Internal error: Missing address input parameter."}if(!Encapsule.code.lib.js.dictionaryLength(n.store.observers)){return}i=n.dispatchCallback;i(e,"onComponentCreated",t);e.visitSubaddressesAscending(function(e){return i(e,"onNamespaceCreated",t)});return true}catch(s){throw"ONMjs.implementation.StoreReifier failure: "+s}};this.unreifyStoreComponent=function(e,t){var i;try{if(!(e!=null&&e)){throw"Internal error: Missing address input parameter."}if(!Encapsule.code.lib.js.dictionaryLength(n.store.observers)){return}i=n.dispatchCallback;e.visitSubaddressesDescending(function(e){return i(e,"onNamespaceRemoved",t)});i(e,"onComponentRemoved",t);return true}catch(s){throw"ONMjs.implementation.StoreReifier failure: "+s}};this.reifyStoreExtensions=function(t,i,s){var r;try{if(!(t!=null&&t)){throw"Internal error: Missing address input parameter."}if(!Encapsule.code.lib.js.dictionaryLength(n.store.observers)){return}r=n.dispatchCallback;return t.visitExtensionPointAddresses(function(t){var r;r=new e.Namespace(n.store,t);r.visitExtensionPointSubcomponents(function(e){if(!s){n.reifyStoreComponent(e,i);n.reifyStoreExtensions(e,i,false)}else{n.reifyStoreExtensions(e,i,true);n.unreifyStoreComponent(e,i)}return true});return true})}catch(o){throw"ONMjs.implementation.StoreReifier failure: "+o}}}catch(i){throw"ONMjs.implementation.StoreReifier constructor failed: "+i}}return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});Encapsule.code.lib.onm.implementation=Encapsule.code.lib.onm.implementation!=null&&Encapsule.code.lib.onm.implementation||(this.Encapsule.code.lib.onm.implementation={});e=Encapsule.code.lib.onm;e.Store=function(){function t(t,n){var i,s,r,o=this;try{this.reifier=new e.implementation.StoreReifier(this);if(!(t!=null&&t)){throw"Missing object model parameter!"}this.model=t;this.jsonTag=t.jsonTag;this.label=t.label;this.description=t.description;this.dataReference=void 0;this.objectStoreSource=void 0;this.observers={};this.observersState={};if(n!=null&&n){i=JSON.parse(n);this.objectStore=i[this.jsonTag];if(!(this.objectStore!=null&&this.objectStore)){throw"Cannot deserialize specified JSON string!"}this.objectStoreSource="json"}else{this.dataReference={};this.objectStoreSource="new";s=new e.AddressToken(t,void 0,void 0,0);r=new e.implementation.AddressTokenBinder(this,this.dataReference,s,"new")}this.validateAddressModel=function(e){try{if(!(e!=null&&e)){throw"Missing address input parameter."}return o.model.isEqual(e.model)}catch(t){throw"ONMjs.Store.verifyAddress failure: "+t}};this.createComponent=function(t){var n,i;try{if(!(t!=null&&t)){throw"Missing object model namespace selector input parameter."}if(!o.validateAddressModel(t)){throw"The specified address cannot be used to reference this store because it's not bound to the same model as this store."}if(t.isQualified()){throw"The specified address is qualified and may only be used to specify existing objects in the store."}i=t.implementation.getDescriptor();if(!i.isComponent){throw"The specified address does not specify the root of a component."}if(i.namespaceType==="root"){throw"The specified address refers to the root namespace of the store which is created automatically."}n=new e.Namespace(o,t,"new");return n}catch(s){throw"ONMjs.Store.createComponent failure: "+s}};this.removeComponent=function(e){var t,n,i,s,r,a;try{if(!(e!=null&&e)){throw"Missing address input parameter!"}if(!o.validateAddressModel(e)){throw"The specified address cannot be used to reference this store because it's not bound to the same model as this store."}if(!e.isQualified()){throw"You cannot use an unqualified address to remove a component."}s=e.implementation.getDescriptor();if(!s.isComponent){throw"The specified address does not specify the root of a component."}if(s.namespace==="root"){throw"The specified address refers to the root namespace of the store which cannot be removed."}o.reifier.reifyStoreExtensions(e,void 0,true);o.reifier.unreifyStoreComponent(e);i=o.openNamespace(e);r=e.createParentAddress();a=o.openNamespace(r);t=a.data();n=e.implementation.getLastToken().key;delete t[n];a.update();return i}catch(c){throw"ONMjs.Store.removeComponent failure: "+c}};this.openNamespace=function(t){var n;try{if(!(t&&t)){throw"Missing address input parameter."}if(!o.validateAddressModel(t)){throw"The specified address cannot be used to reference this store because it's not bound to the same model as this store."}n=new e.Namespace(o,t,"bypass");return n}catch(i){throw"ONMjs.Store.openNamespace failure: "+i}};this.toJSON=function(e,t){var n,i;try{i=o.openNamespace(o.model.createRootAddress());n=i.toJSON(e,t);return n}catch(s){throw"ONMjs.Store.toJSON fail on object store "+o.jsonTag+" : "+s}};this.registerObserver=function(e,t){var n,i;try{if(!(e!=null&&e)){throw"Missing callback interface namespace input parameter.."}e.observingEntity=t;n=uuid.v4();o.observers[n]=e;i=o.model.createRootAddress();o.reifier.dispatchCallback(void 0,"onObserverAttachBegin",n);o.reifier.reifyStoreComponent(i,n);o.reifier.reifyStoreExtensions(i,n);o.reifier.dispatchCallback(void 0,"onObserverAttachEnd",n);return n}catch(s){throw"ONMjs.Store.registerObserver failure: "+s}};this.unregisterObserver=function(e){var t,n;try{if(!(e!=null&&e)){throw"Missing observer ID code input parameter!"}t=o.observers[e];if(!(t!=null&&t)){throw"Unknown observer ID code provided. No registration to remove."}o.reifier.dispatchCallback(void 0,"onObserverDetachBegin",e);n=o.model.createRootAddress();o.reifier.reifyStoreExtensions(n,e,true);o.reifier.unreifyStoreComponent(n,e);o.reifier.dispatchCallback(void 0,"onObserverDetachEnd",e);o.removeObserverState(e);return delete o.observers[e]}catch(i){throw"ONMjs.Store.unregisterObserver failure: "+i}};this.openObserverState=function(e){var t;try{if(!(e!=null&&e)){throw"Missing observer ID parameter!"}t=o.observersState[e]!=null&&o.observersState[e]||(o.observersState[e]=[]);return t}catch(n){throw"ONMjs.Store.openObserverStateObject failure: "+n}};this.removeObserverState=function(e){if(!(e!=null&&e)){throw"Missing observer ID parameter!"}if(typeof observerState!=="undefined"&&observerState!==null&&observerState){if(o.observerState[e]!=null&&o.observerState[e]){delete o.observerState[e]}}return o};this.openObserverComponentState=function(e,t){var n,i;try{if(!(e!=null&&e)){throw"Missing observer ID parameter."}if(!(t!=null&&t)){throw"Missing address input parameter."}s=t.implementation.getLastToken();i=s.componentDescriptor.id;n=t.createComponentAddress();return o.openObserverNamespaceState(e,n)}catch(r){throw"ONMjs.Store.openObserverComponentState failure: "+r}};this.openObserverNamespaceState=function(e,t){var n,i,r,a,c;try{if(!(e!=null&&e)){throw"Missing observer ID parameter."}if(!(t!=null&&t)){throw"Missing address input parameter."}c=o.openObserverState(e);s=t.implementation.getLastToken();n=s.namespaceDescriptor.id;i=c[n]!=null&&c[n]||(c[n]={});a=t.getHashString();r=i[a]!=null&&i[a]||(i[a]={});return r}catch(l){throw"ONMjs.Store.openObserverNamespaceState failure: "+l}};this.removeObserverNamespaceState=function(e,t){var n,i,s;i=o.modelViewObserversState[e];if(!(i!=null&&i)){return o}s=i[namespaceSelector_.pathId];if(!(s!=null&&s)){return o}n=namespaceSelector_.getHashString();delete s[n];if(Encapsule.code.lib.js.dictionaryLength(s)===0){delete i[namespaceSelector_.pathId]}return o}}catch(a){throw"ONMjs.Store failure: "+a}}return t}();t=typeof Encapsule!=="undefined"&&Encapsule!==null&&Encapsule||(this.Encapsule={});Encapsule.code=Encapsule.code!=null&&Encapsule.code||(this.Encapsule.code={});Encapsule.code.lib=Encapsule.code.lib!=null&&Encapsule.code.lib||(this.Encapsule.code.lib={});Encapsule.code.lib.onm=Encapsule.code.lib.onm!=null&&Encapsule.code.lib.onm||(this.Encapsule.code.lib.onm={});e=Encapsule.code.lib.onm;e.CachedAddress=function(t){s(i,t);function i(t,s){this.setAddress=n(this.setAddress,this);this.getAddress=n(this.getAddress,this);var r,o,a=this;try{if(!(t!=null&&t)){throw"Missing object store input parameter. Unable to determine external selector type."}this.referenceStore=t;o=new e.Model({jsonTag:"cachedAddress",label:""+t.model.jsonTag+" Address Cache",description:""+t.model.label+" observable address cache."});i.__super__.constructor.call(this,o);r=o.createRootAddress();this.selectorNamespace=new e.Namespace(this,r);this.selectorNamespaceData=this.selectorNamespace.data();this.selectorNamespaceData.selectedNamespace=void 0;this.setAddress(s);this.objectStoreCallbacks={onNamespaceUpdated:function(e,t,n){var i;try{i=a.getAddress();if(i.isEqual(n)){return a.setAddress(n)}}catch(s){throw"ONMjs.CachedAddress.objectStoreCallbacks.onNamespaceUpdated failure: "+s}},onNamespaceRemoved:function(e,t,n){var i,s;try{i=a.getAddress();if(i.isEqual(n)){s=i.createParentAddress();a.setAddress(s)}}catch(r){throw"ONMjs.CachedAddress.objectStoreCallbacks.onNamespaceRemoved failure: "+r}}}}catch(c){throw"ONMjs.CachedAddress failure: "+c}}i.prototype.getAddress=function(){var e;try{e=this.selectorNamespaceData.selectedNamespace;if(!(e!=null&&e)){return void 0}return e.getResolvedAddress()}catch(t){throw"ONMjs.CachedAddress.getSelector failure: "+t}};i.prototype.setAddress=function(t){try{if(!(t&&t)){this.selectorNamespaceData.selectedNamespace=void 0}else{this.selectorNamespaceData.selectedNamespace=new e.Namespace(this.referenceStore,t)}return this.selectorNamespace.update()}catch(n){throw"ONMjs.CachedAddress.setAddress failure: "+n}};return i}(e.Store);Encapsule.code.lib.onm.about={};Encapsule.code.lib.onm.about.version="0.0.6";Encapsule.code.lib.onm.about.build="Tue Oct 15 02:31:29 UTC 2013";Encapsule.code.lib.onm.about.epoch="1381804289";Encapsule.code.lib.onm.about.uuid="2d82e89e-b670-49e4-8884-7f0f43a0dd55"}).call(this)})();